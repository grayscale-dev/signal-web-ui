import{p as e,H as t,c as a,h as s,t as i}from"./index.js";const l=e(class extends t{constructor(e){super(),!1!==e&&this.__registerHost(),this.__attachShadow(),this.rowClick=a(this,"rowClick"),this.selectionChanged=a(this,"selectionChanged"),this.sortChange=a(this,"sortChange"),this.filterChange=a(this,"filterChange"),this.searchChange=a(this,"searchChange"),this.pageChange=a(this,"pageChange"),this.columns=[],this.rows=[],this.searchable=!1,this.filterable=!1,this.selectable=!1,this.selectedKeys=[],this.emptyText="No results",this.filters=[],this.loading=!1,this.searchQuery="",this.internalFilters={},this.internalSelection={},this.handleSearch=e=>{const t=e.target.value;this.searchQuery=t,this.searchChange.emit({query:t})},this.handleFilterChange=(e,t)=>{this.internalFilters={...this.internalFilters,[e]:t},this.filterChange.emit({filters:this.internalFilters})}}componentWillLoad(){this.internalFilters=this.filters.reduce(((e,t)=>(t.value&&(e[t.key]=t.value),e)),{}),this.internalSelection=this.selectedKeys.reduce(((e,t)=>(e[t]=!0,e)),{})}getRowId(e,t){return"function"==typeof this.rowKey?this.rowKey(e):"string"==typeof this.rowKey&&null!=e[this.rowKey]?e[this.rowKey]+"":t+""}handleSort(e){if(!e.sortable)return;const t=this.internalSort&&this.internalSort.key===e.key?"asc"===this.internalSort.direction?{key:e.key,direction:"desc"}:void 0:{key:e.key,direction:"asc"};this.internalSort=t,this.sortChange.emit({sort:t})}toggleRowSelection(e){const t={...this.internalSelection};t[e]=!t[e],this.internalSelection=t;const a=Object.keys(t).filter((e=>t[e]));this.selectionChanged.emit({keys:a})}toggleAllSelection(e){const t=e.every(((e,t)=>this.internalSelection[this.getRowId(e,t)])),a={};t||e.forEach(((e,t)=>{a[this.getRowId(e,t)]=!0})),this.internalSelection=a;const s=Object.keys(a).filter((e=>a[e]));this.selectionChanged.emit({keys:s})}changePage(e){this.pagination&&this.pageChange.emit({pageIndex:Math.max(0,this.pagination.pageIndex+e),pageSize:this.pagination.pageSize})}get filteredRows(){let e=[...this.rows];if(this.searchable&&this.searchQuery){const t=this.searchQuery.toLowerCase();e=e.filter((e=>this.columns.some((a=>((e[a.key]??"")+"").toLowerCase().includes(t)))))}if(this.filterable&&(e=e.filter((e=>Object.entries(this.internalFilters).every((([t,a])=>!a||(e[t]??"")+""===a))))),this.internalSort){const{key:t,direction:a}=this.internalSort;e=[...e].sort(((e,s)=>{const i=e[t],l=s[t];return null==i&&null==l?0:null==i?1:null==l?-1:i===l?0:"asc"===a?i>l?1:-1:i<l?1:-1}))}return e}get pagedRows(){if(!this.pagination)return this.filteredRows;const e=this.pagination.pageIndex*this.pagination.pageSize;return this.filteredRows.slice(e,e+this.pagination.pageSize)}renderToolbar(e){return this.searchable||this.filterable||this.selectable?s("div",{part:"toolbar",class:"toolbar"},this.selectable&&s("label",{class:"checkbox"},s("input",{type:"checkbox",checked:e.length>0&&e.every(((e,t)=>this.internalSelection[this.getRowId(e,t)])),onChange:()=>this.toggleAllSelection(e)}),s("span",null,"Select all")),this.searchable&&s("input",{part:"search",class:"search",type:"search",placeholder:"Search…",value:this.searchQuery,onInput:this.handleSearch}),this.filterable&&s("div",{class:"filters"},this.filters.map((e=>s("label",{class:"filter",key:e.key},s("span",{class:"filter-label"},e.label),s("select",{class:"filter-select",onInput:t=>this.handleFilterChange(e.key,t.target.value)},s("option",{value:""},"Any"),e.options.map((t=>s("option",{key:t.value,value:t.value,selected:(this.internalFilters[e.key]??"")===t.value},t.label))))))))):null}renderPagination(e){if(!this.pagination)return null;const{pageIndex:t,pageSize:a}=this.pagination,i=t*a+1,l=Math.min(e,i+a-1),r=e;return s("div",{part:"pagination",class:"pagination"},s("div",{class:"pagination-meta"},i,"-",l," of ",r),s("div",{class:"pagination-actions"},s("button",{part:"page-prev",class:"button",onClick:()=>this.changePage(-1),disabled:0===t},"Prev"),s("button",{part:"page-next",class:"button",onClick:()=>this.changePage(1),disabled:l>=r},"Next")))}render(){const e=this.pagedRows,t=this.filteredRows.length;return s("div",{key:"6ed357c24eee8377c13d15756192f60e55fd9de0",part:"root",class:"root","data-loading":this.loading?"true":"false"},this.caption&&s("div",{key:"595667a40ec4dddfc93913becbd25ae6599ac16b",part:"caption",class:"caption"},this.caption),this.renderToolbar(e),s("div",{key:"850cf33971e2f882a80c6d6426c729555c56c527",class:"table-wrapper"},s("table",{key:"5fe73993bf98897efa504c12c79ed1a8bcba44cb",part:"table",class:"table"},s("thead",{key:"48f4b93ab14cf0ba632c421319c7bd1f4bac21f2",part:"head",class:"head"},s("tr",{key:"02cafd059a8a5443ad2b9dd0fac9a87c725b10e1"},this.selectable&&s("th",{key:"4f1fa817f0d640433bcc0df6b5e61c2c11434a38",class:"selection-col"}),this.columns.map((e=>{const t=this.internalSort?.key===e.key,a=this.internalSort?.direction;return s("th",{part:"header",key:e.key,style:e.width?{width:e.width}:void 0,class:{header:!0,sortable:!!e.sortable,["align-"+(e.align??"left")]:!0,sorted:t},onClick:()=>this.handleSort(e)},s("div",{class:"header-content"},s("slot",{name:"header-"+e.key},e.header),e.sortable&&s("span",{class:"sort-indicator","aria-hidden":"true"},t?"asc"===a?"▲":"▼":"↕")))})),s("th",{key:"39461de7d5b83697942d8a9cd15b43c0c6f677bf",class:"actions-col"},s("slot",{key:"97e32c27afaf1d209ac5c27c6d50fcda9bab1537",name:"actions-header"})))),s("tbody",{key:"0ccf4a6c8c7327894a23530ed6876b32f176679d",part:"body",class:"body"},this.loading?s("tr",null,s("td",{class:"empty",colSpan:this.columns.length+(this.selectable?1:0)+1},s("slot",{name:"loading"},"Loading…"))):0===e.length?s("tr",null,s("td",{class:"empty",colSpan:this.columns.length+(this.selectable?1:0)+1},s("slot",{name:"empty"},this.emptyText))):e.map(((e,t)=>{const a=this.getRowId(e,t),i=this.internalSelection[a];return s("tr",{part:"row",key:a,class:{row:!0,selected:i},onClick:()=>this.rowClick.emit({row:e})},this.selectable&&s("td",{class:"selection-col cell"},s("label",{class:"checkbox"},s("input",{type:"checkbox",checked:!!i,onClick:e=>e.stopPropagation(),onChange:()=>this.toggleRowSelection(a),"aria-label":"Select row"}))),this.columns.map((t=>s("td",{part:"cell",key:t.key,class:{cell:!0,["align-"+(t.align??"left")]:!0}},s("slot",{name:"cell-"+t.key},t.render?t.render(e):e[t.key]??"—")))),s("td",{class:"actions-col cell"},s("slot",{name:"row-actions","row-id":a})))}))))),this.renderPagination(t))}static get style(){return':host{--signal-table-border:var(--signal-border, #e5e7eb);--signal-table-surface:var(--signal-surface, #ffffff);--signal-table-muted:var(--signal-muted, #f3f4f6);--signal-table-text:var(--signal-text, #111827);--signal-table-subtle:var(--signal-subtle, #6b7280);--signal-table-radius:12px;--signal-table-shadow:0 8px 20px rgba(17, 24, 39, 0.06);--signal-accent:var(--signal-accent, #2563eb)}.root{border:1px solid var(--signal-table-border);border-radius:var(--signal-table-radius);background:var(--signal-table-surface);-webkit-box-shadow:var(--signal-table-shadow);box-shadow:var(--signal-table-shadow);overflow:hidden}.caption{padding:12px 16px;font-size:0.95rem;font-weight:600;color:var(--signal-table-text)}.toolbar{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:center;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid var(--signal-table-border);background:var(--signal-table-muted)}.search{-ms-flex:1 1 220px;flex:1 1 220px;min-width:180px;padding:8px 10px;border:1px solid var(--signal-table-border);border-radius:8px;background:#fff}.filters{display:-ms-flexbox;display:flex;gap:12px;-ms-flex-wrap:wrap;flex-wrap:wrap}.filter{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;gap:6px}.filter-label{font-size:0.85rem;color:var(--signal-table-subtle)}.filter-select{padding:6px 8px;border:1px solid var(--signal-table-border);border-radius:8px;background:#fff}.table-wrapper{overflow:auto}.table{width:100%;border-collapse:collapse;text-align:left;color:var(--signal-table-text);font-size:0.9375rem}.head th{background:var(--signal-table-muted);color:var(--signal-table-subtle);font-weight:600;letter-spacing:0.04em;text-transform:uppercase;padding:12px 16px;border-bottom:1px solid var(--signal-table-border);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.header-content{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;gap:6px}.sortable{cursor:pointer}.sort-indicator{font-size:0.75rem;color:var(--signal-table-subtle)}.body .row{border-top:1px solid var(--signal-table-border);-webkit-transition:background-color 120ms ease;transition:background-color 120ms ease}.body .row:hover{background:var(--signal-table-muted);cursor:pointer}.cell{padding:12px 16px;vertical-align:middle;color:var(--signal-table-text)}.align-center{text-align:center}.align-right{text-align:right}.selection-col{width:44px;text-align:center}.actions-col{width:60px;text-align:right}.checkbox{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-align:center;align-items:center;gap:6px;font-size:0.9rem;color:var(--signal-table-text)}.empty{text-align:center;color:var(--signal-table-subtle);padding:18px 16px}.pagination{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:center;align-items:center;padding:12px 16px;border-top:1px solid var(--signal-table-border);background:var(--signal-table-muted)}.pagination-meta{color:var(--signal-table-subtle);font-size:0.9rem}.pagination-actions{display:-ms-flexbox;display:flex;gap:8px}.button{padding:8px 12px;border:1px solid var(--signal-table-border);border-radius:8px;background:#fff;cursor:pointer}.button:disabled{opacity:0.5;cursor:not-allowed}.row.selected{background:rgba(37, 99, 235, 0.06)}[data-loading="true"]{opacity:0.7;pointer-events:none}'}},[257,"signal-feature-table",{columns:[16],rows:[16],caption:[1],rowKey:[1,"row-key"],searchable:[516],filterable:[516],selectable:[516],selectedKeys:[16],pagination:[16],emptyText:[1,"empty-text"],filters:[16],loading:[516],searchQuery:[32],internalSort:[32],internalFilters:[32],internalSelection:[32]}]),r=l,n=function(){"undefined"!=typeof customElements&&["signal-feature-table"].forEach((e=>{"signal-feature-table"===e&&(customElements.get(i(e))||customElements.define(i(e),l))}))};export{r as SignalFeatureTable,n as defineCustomElement}