import{p as t,H as s,c as i,h as e,t as a}from"./index.js";const o=t(class extends s{constructor(t){super(),!1!==t&&this.__registerHost(),this.__attachShadow(),this.valueChange=i(this,"valueChange"),this.openChange=i(this,"openChange"),this.queryChange=i(this,"queryChange"),this.clear=i(this,"clear"),this.options=[],this.mode="single",this.placeholder="Select",this.disabled=!1,this.loading=!1,this.clearable=!1,this.searchable=!0,this.creatable=!1,this.open=!1,this.query="",this.highlightedIndex=0,this.internalValue=null,this.listId="signal-combobox-"+Math.random().toString(36).slice(2),this.toggleOpen=()=>{this.disabled||(this.open=!this.open,this.open||(this.query="",this.highlightedIndex=0))},this.openListbox=()=>{this.disabled||(this.open=!0)},this.closeListbox=()=>{this.open=!1,this.query="",this.highlightedIndex=0,this.triggerEl?.focus()},this.handleSelect=t=>{if(!t.disabled)if(this.isMulti){const s=Array.isArray(this.selectedValue)?[...this.selectedValue]:[],i=s.includes(t.value)?s.filter((s=>s!==t.value)):[...s,t.value];if(this.maxSelected&&i.length>this.maxSelected)return;this.setSelectedValue(i),(this.closeOnSelect??!this.isMulti)&&this.closeListbox()}else this.setSelectedValue(t.value),this.closeListbox()},this.handleClear=()=>{this.setSelectedValue(this.isMulti?[]:""),this.query="",this.clear.emit()},this.handleInput=t=>{const s=t.target.value;this.query=s,this.highlightedIndex=0,this.queryChange.emit({query:s})},this.handleKeyDown=t=>{const s=this.filteredOptions;if("ArrowDown"===t.key&&(t.preventDefault(),this.open?this.highlightedIndex=Math.min(s.length-1,this.highlightedIndex+1):this.openListbox()),"ArrowUp"===t.key&&(t.preventDefault(),this.open?this.highlightedIndex=Math.max(0,this.highlightedIndex-1):this.openListbox()),"Enter"===t.key){if(!this.open)return void this.openListbox();t.preventDefault();const i=s[this.highlightedIndex];i?this.handleSelect(i):this.creatable&&this.query&&(this.setSelectedValue(this.isMulti?[...Array.isArray(this.selectedValue)?this.selectedValue:[],this.query]:this.query),this.closeListbox())}"Escape"===t.key&&this.open&&(t.preventDefault(),this.closeListbox())},this.handleOptionKeyDown=(t,s)=>{s.disabled||"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),this.handleSelect(s))},this.handleCreateOption=()=>{if(!this.creatable||!this.query)return;const t=this.isMulti?[...Array.isArray(this.selectedValue)?this.selectedValue:[],this.query]:this.query;this.setSelectedValue(t),this.closeListbox()}}onOpenChange(t){this.openChange.emit({open:t}),t&&requestAnimationFrame((()=>{this.inputEl?.focus()}))}componentWillLoad(){this.internalValue=void 0!==this.defaultValue?this.defaultValue:"multi"===this.mode?[]:""}handleOutsideClick(t){this.open&&(t.composedPath().includes(this.host)||this.closeListbox())}get isMulti(){return"multi"===this.mode}get selectedValue(){return void 0!==this.value?this.value:this.internalValue}setSelectedValue(t){void 0===this.value&&(this.internalValue=t),this.valueChange.emit({value:t})}get filteredOptions(){if(!this.query)return this.options;const t=this.query.toLowerCase();return this.options.filter((s=>s.label.toLowerCase().includes(t)))}get selectedLabels(){if(this.isMulti){const t=Array.isArray(this.selectedValue)?this.selectedValue:[];return this.options.filter((s=>t.includes(s.value))).map((t=>t.label))}const t=this.options.find((t=>t.value===this.selectedValue));return t?[t.label]:[]}render(){const t=this.selectedLabels,s=t.length?t.join(", "):"",i=this.filteredOptions,a=i[this.highlightedIndex],o=this.clearable&&(this.isMulti?t.length>0:!!s);return e("div",{key:"4ca7002fcbc587647e732fca6cf3b359087bda2f",part:"container",class:{container:!0,open:this.open,disabled:this.disabled}},e("div",{key:"1779794539cd275631b289fd7afee9a447a2950d",part:"control",class:"control"},e("button",{key:"86ca0edb9fd65dd0f24e4fe9439be46b78807cb0",part:"trigger",class:"trigger",type:"button",ref:t=>this.triggerEl=t,"aria-haspopup":"listbox","aria-expanded":this.open?"true":"false","aria-controls":this.listId,disabled:this.disabled,onClick:this.toggleOpen,onKeyDown:this.handleKeyDown},e("span",{key:"93c74567dd866f8545f2ee339ba53b56a02cd037",part:"value",class:{value:!0,placeholder:!s}},s||this.placeholder),e("span",{key:"ebeda586f5c4e0e832a4e2c6e41f21cf9f153f9b",part:"caret",class:"caret","aria-hidden":"true"},"▾")),this.open&&e("input",{key:"eee7ae32175f1e68012799ceb7e0e09979abc01d",part:"input",class:"input",ref:t=>this.inputEl=t,placeholder:this.placeholder,value:this.query,readonly:!this.searchable,onInput:this.searchable?this.handleInput:void 0,onKeyDown:this.handleKeyDown,"aria-autocomplete":"list","aria-controls":this.listId,"aria-activedescendant":a?`${this.listId}-option-${this.highlightedIndex}`:void 0}),o&&e("button",{key:"02a26e9fc7d5cc371740449f8152bf78de60855c",part:"clear",class:"clear",type:"button",onClick:this.handleClear,"aria-label":"Clear selection"},"Clear")),this.open&&e("div",{key:"24404ddf0cc0fcc0c9673cd4f2ea1f96112aa7ee",part:"listbox",id:this.listId,class:"listbox",role:"listbox","aria-multiselectable":this.isMulti?"true":"false"},this.loading&&e("div",{key:"f66b5f560e477511fe67ff90a5a79e589969b007",part:"empty",class:"empty"},"Loading..."),!this.loading&&0===i.length&&e("div",{key:"a49ea39d1a9d55fd7a6fd8df01494c2abb9a680a",part:"empty",class:"empty"},"No options"),!this.loading&&i.map(((t,s)=>{const i=this.isMulti?Array.isArray(this.selectedValue)&&this.selectedValue.includes(t.value):this.selectedValue===t.value;return e("div",{part:i?"option option-selected":"option",class:{option:!0,selected:i,active:t.value===a?.value,disabled:!!t.disabled},role:"option",id:`${this.listId}-option-${s}`,"aria-selected":i?"true":"false","aria-disabled":t.disabled?"true":"false",key:t.value,tabIndex:t.disabled?-1:0,onMouseDown:t=>t.preventDefault(),onClick:()=>this.handleSelect(t),onKeyDown:s=>this.handleOptionKeyDown(s,t)},e("span",{class:"option-label"},t.label),i&&e("span",{class:"check"},"✓"))})),this.creatable&&this.query&&!i.some((t=>t.label===this.query))&&e("div",{key:"5a939e69eddfcc347189aa095a1322bf23c86e64",part:"option option-create",class:"option create",role:"option",tabIndex:0,"aria-selected":"false",onClick:this.handleCreateOption,onKeyDown:t=>this.handleOptionKeyDown(t,{value:this.query,label:this.query})},`Create "${this.query}"`)))}get host(){return this}static get watchers(){return{open:[{onOpenChange:0}]}}static get style(){return":host{display:block;font-family:var(--signal-font-sans);position:relative}.container{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;gap:var(--signal-space-2)}.control{position:relative}.trigger{-ms-flex-align:center;align-items:center;background:var(--signal-color-surface);border:1px solid var(--signal-color-border);border-radius:var(--signal-radius-md);color:var(--signal-color-text);cursor:pointer;display:-ms-flexbox;display:flex;font:inherit;font-size:13px;-ms-flex-pack:justify;justify-content:space-between;padding:8px 14px;width:100%}.trigger:focus-visible{-webkit-box-shadow:var(--signal-shadow-focus);box-shadow:var(--signal-shadow-focus);outline:none}.value.placeholder{color:var(--signal-color-subtle)}.caret{color:var(--signal-color-subtle);margin-left:var(--signal-space-2)}.input{position:absolute;inset:0;border-radius:var(--signal-radius-md);border:1px solid var(--signal-color-accent);background:var(--signal-color-surface);padding:8px 14px;font:inherit;font-size:13px;color:var(--signal-color-text)}.input:focus{outline:none;-webkit-box-shadow:var(--signal-shadow-focus);box-shadow:var(--signal-shadow-focus)}.clear{position:absolute;right:34px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);background:transparent;border:none;color:var(--signal-color-subtle);cursor:pointer;font-size:11px;padding:2px 6px}.clear:hover{background:var(--signal-color-muted);border-radius:var(--signal-radius-sm)}.listbox{border:1px solid var(--signal-color-border);border-radius:var(--signal-radius-md);background:var(--signal-color-surface);-webkit-box-shadow:var(--signal-shadow-strong);box-shadow:var(--signal-shadow-strong);max-height:280px;overflow:auto;padding:var(--signal-space-1) 0}.option{-ms-flex-align:center;align-items:center;color:var(--signal-color-text);cursor:pointer;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;padding:8px 12px;font-size:13px}.option.active,.option:hover{background:var(--signal-color-muted)}.option.selected{font-weight:600}.option.disabled{cursor:not-allowed;opacity:0.6}.option.create{font-style:italic}.option-label{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.check{color:var(--signal-color-accent);margin-left:var(--signal-space-2)}.empty{padding:10px 12px;font-size:12px;color:var(--signal-color-subtle)}:host([disabled]) .trigger{cursor:not-allowed;opacity:0.6}:host([disabled]) .input{cursor:not-allowed}"}},[1,"signal-combobox",{options:[16],value:[1025],defaultValue:[1,"default-value"],mode:[513],placeholder:[1],disabled:[516],loading:[516],clearable:[516],searchable:[516],creatable:[516],maxSelected:[2,"max-selected"],closeOnSelect:[516,"close-on-select"],open:[32],query:[32],highlightedIndex:[32],internalValue:[32]},[[5,"mousedown","handleOutsideClick"]],{open:[{onOpenChange:0}]}]),r=o,n=function(){"undefined"!=typeof customElements&&["signal-combobox"].forEach((t=>{"signal-combobox"===t&&(customElements.get(a(t))||customElements.define(a(t),o))}))};export{r as SignalCombobox,n as defineCustomElement}